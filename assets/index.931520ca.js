import{c as Ye,a as Ze,i as Be,r as et,S as Fe,W as $e,P as He,b as We,O as je,V as ae,e as p,C as Qe,M as ct,B as at,d as R,f as X,G as st,m as N,g as _,h as qe,D as Ke,I as mt,E as Ve,F as Je,T as oe,j as Bt,w as pt,H as ie,k as xt,l as re,v as tn,n as Ft,t as en,o as nt,p as G,q as D,s as c,u as rt,x as w,y as nn,z as sn,R as an,A as on,J as x,K as W,L as k,N as bt,Q as j,U as S,X as Z,Y as rn,Z as $t,_ as ln,$ as cn,a0 as dn,a1 as hn}from"./vendor.0cc6517e.js";const un=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}};un();const pn=Ye({id:"main",initial:"loading",context:{difficulty:0},states:{loading:{on:{INTRO_IN:"introIn"}},introIn:{tags:"intro",on:{DONE:"introIdle"}},introIdle:{tags:"intro",on:{INTRO_OUT:"introOut",DIFFICULTY:{actions:["setDifficulty"]}}},introOut:{tags:"intro",on:{DONE:"gameIn"}},gameIn:{tags:"board",on:{DONE:"gamePlaying"}},gamePlaying:{tags:"board",initial:"playing",states:{playing:{on:{LOSE:"lose",WIN:"win",QUIT:"quit"}},lose:{on:{DONE:"#main.gameOut"}},win:{on:{DONE:"#main.gameOut"}},quit:{on:{DONE:"#main.gameOut",CANCEL:"playing"}}},on:{GAME_OUT:"gameOut"}},gameOut:{tags:"board",on:{DONE:"introIn"}}}},{actions:{setDifficulty:Ze({difficulty:r=>(r.difficulty+1)%3})}}),M=Be(pn).start(),T=et(M.state);M.onTransition(r=>T.value=r);const Ht=new Fe,mn=()=>{const r=document.getElementById("three");r.innerHTML="",r.appendChild(J.domElement)},J=new $e({antialias:!0,alpha:!0,shadow:!0});J.setSize(window.innerWidth,window.innerHeight);J.shadowMap.enabled=!0;J.shadowMap.type=He;const O=new We(50,window.innerWidth/window.innerHeight,1,1e3);O.position.set(15,9,15);const E=new je(O,J.domElement);E.enableDamping=!0;E.enableRotate=!0;E.enableZoom=!0;E.enablePan=!1;E.autoRotate=!0;E.autoRotateSpeed=-2;const gn=new ae(0,0,0),fn=()=>{const r=E.target,t=gn;new p.Tween(r).to(t,500).easing(p.Easing.Cubic.InOut).onUpdate(()=>E.target=r).start();const e={x:O.position.x,y:O.position.y,z:O.position.z},n={x:80,y:35,z:80};new p.Tween(e).to(n,500).easing(p.Easing.Cubic.InOut).onUpdate(()=>{O.position.set(e.x,e.y,e.z),E.update()}).start()},wn=new Qe,z=(r,t,e,n,s,a=!0)=>{[[0,11,17],[1,9,20],[2,13,19],[3,15,22],[5,10,16],[4,8,21],[7,12,18],[6,14,23]][r].forEach(l=>{let i,d,u,h=t.attributes.position.getX(l),m=t.attributes.position.getY(l),b=t.attributes.position.getZ(l);a?(i=e?h+e:h,d=n?m+n:m,u=s?b+s:b):(i=e||h,d=n||m,u=s||b),t.attributes.position.setXYZ(l,i,d,u)}),t.attributes.position.needsUpdate=!0},lt=(r,t,e)=>{const n=Math.round(Math.random()*(t*1e5-r*1e5)+r*1e5)/1e5;return e&&n>=e.min&&n<=e.max?lt(r,t,e):n},v=(r,t,e)=>{let n=Math.round(Math.random()*(t-r)+r);return n===e&&(n=v(r,t,e)),n},q=(r,t=!1)=>{const e=Math.floor(Math.random()*r.length),n=r[e];return t&&r.splice(e,1),n},yn=(r,t,e,n=0)=>{const s=JSON.parse(JSON.stringify(r)),a=JSON.parse(JSON.stringify(r));if(n>0&&(a.splice(-n),a.splice(0,n),a.forEach(h=>{h.splice(-n),h.splice(0,n)})),a.flat(2).every(h=>!!h))return null;const o=0-Math.floor(t/2),l=0-Math.floor(e/2);let i,d;do i=v(n,t-n-1),d=v(n,e-n-1);while(s[d][i]);return{tile:{x:i+o,y:0,z:d+l},x:i,z:d}},le=(r,t,e={width:0,direction:0})=>{const{width:n,direction:s}=e,a=n/2;let o,l,i=lt(r,t),d=0,u=lt(r,t);for(s===0||s==4?(o=h=>h>a||h<-a,l=()=>!0):s===3||s==7?(o=()=>!0,l=(h,m)=>m>h+a||m<h-a):s===2||s==6?(o=()=>!0,l=(h,m)=>m>a||m<-a):(s===1||s==5)&&(o=()=>!0,l=(h,m)=>m>-h+a||m<-h-a);!o(i);)i=lt(r,t);for(;!l(i,u);)u=lt(r,t);return{x:i,y:d,z:u}},_n=(r,t,e)=>{const n=Math.ceil(0-t/2),s=Math.abs(n),a=Math.ceil(0-e/2),o=Math.abs(a),{x:l,z:i}=r;return l===n-1?i===a-1?3:i===o+1?1:2:l===s+1?i===a-1?5:i===o+1?7:6:i===a-1?4:0},bn=(r,t,e)=>{const n=Math.ceil(0-t/2),s=Math.abs(n),a=Math.ceil(0-e/2),o=Math.abs(a),{x:l,z:i}=r;return l===n-1?i===a-1?7:i===o+1?5:6:l===s+1?i===a-1?1:i===o+1?3:2:i===a-1?0:4},Pt=(r,t)=>{let{x:e,y:n,z:s}=r;return t===0?s--:t===1?(e++,s--):t===2?e++:t===3?(e++,s++):t===4?s++:t===5?(e--,s++):t===6?e--:t===7&&(e--,s--),{x:e,y:n,z:s}},vn=(r,t)=>{let{x:e,y:n,z:s}=r;return t===0?s++:t===1?(e--,s++):t===2?e--:t===3?(e--,s--):t===4?s--:t===5?(e++,s--):t===6?e++:t===7&&(e++,s++),{x:e,y:n,z:s}},Wt=r=>{const t=Math.floor(r/4).toString(),e=(r%4*15).toString();return`${t.padStart(2,"0")}:${e.padStart(2,"0")}`},xn=(r,t,e)=>{const n=Math.random()>.7,s=Math.ceil(0-r/2)-1,a=Math.abs(s),o=Math.ceil(0-t/2)-1,l=Math.abs(o),i=[s,a,0],d=[o,l],u=[o,l,0],h=q(i),m=Math.ceil(Math.random()*9),b=q(h===0?d:u),I={x:h,y:m,z:b};return n?ce(e):{position:I,direction:_n(I,r,t),name:`${de(I)}${m}`}},jt=(r,t,e)=>{const n=Math.random()>.3,s=Math.ceil(0-r/2)-1,a=Math.abs(s),o=Math.ceil(0-t/2)-1,l=Math.abs(o),i=[s,a,0],d=[o,l],u=[o,l,0],h=q(i),m=Math.ceil(Math.random()*9),b=q(h===0?d:u),I={x:h,y:m,z:b};return n?ce(e):{position:I,direction:bn(I,r,t),name:`${de(I)}${m}`}},ce=r=>q(r),de=r=>{const{x:t,z:e}=r;if(t===0){if(e>0)return"S";if(e<0)return"N"}else if(t<0){if(e<0)return"NW";if(e===0)return"W";if(e>0)return"SW"}else if(t>0){if(e<0)return"NE";if(e===0)return"E";if(e>0)return"SE"}},kn=(r=0)=>{if(r===0)return{x:0,z:1};if(r===1)return{x:-1,z:1};if(r===2)return{x:-1,z:0};if(r===3)return{x:-1,z:-1};if(r===4)return{x:0,z:-1};if(r===5)return{x:1,z:-1};if(r===6)return{x:1,z:0};if(r===7)return{x:1,z:1}},he=["EASY","NORMAL","HARD"],Qt={EASY:{width:11,depth:11},NORMAL:{width:15,depth:15},HARD:{width:21,depth:21}},qt={EASY:{min:1,max:2},NORMAL:{min:2,max:3},HARD:{min:3,max:5}},Kt={EASY:{min:1,max:2},NORMAL:{min:3,max:5},HARD:{min:6,max:9}},Ot={EASY:{amount:24,height:5},NORMAL:{amount:48,height:7},HARD:{amount:96,height:9}},L={SCHEDULED:"Scheduled",APPROACHING:"Approaching",IN_FLIGHT:"In flight",OBSTRUCTED:"Obstructed",LANDED:"Landed",EXITED:"Exited",LOST:"Lost",CRASHED:"Crashed"},zn=new ct({color:10053706,flatShading:!0});class En{_tile=null;_dirt=null;constructor(){}add(t={scale:{x:1,y:1,z:1}}){this._tile=t}reset(){this._tile=null,this._dirt=null}create(){const t=new at(10,3,10);return t.translate(0,-2.5,0),t.scale(this._tile.scale.x,this._tile.scale.y,this._tile.scale.z),this._dirt=new R(t,zn),this._dirt.scale.setScalar(0),this._dirt}animateIn(){return this._tile?new Promise(t=>{const e={scale:0},n={scale:1};this.animateUpdate(e),new p.Tween(e).to(n,500).easing(p.Easing.Elastic.InOut).onUpdate(()=>this.animateUpdate(e)).onComplete(t).delay(0).start()}):Promise.resolve()}animateOut(){return this._tile?new Promise(t=>{const e={scale:1},n={scale:0};new p.Tween(e).to(n,500).easing(p.Easing.Elastic.InOut).onUpdate(()=>this.animateUpdate(e)).onComplete(t).delay(1250).start()}):Promise.resolve()}animateUpdate(t){this._dirt.scale.setScalar(t.scale)}}const Gt=new En;class Dt{_position={x:0,y:0,z:0};_model=null;_hasAnimations=!1;_isAnimating=!1;_shouldBeRemoved=!1;_tick=0;displayName="";constructor({position:t={x:0,y:0,z:0}}={}){this._position=t}updatePosition(){this._model.position.x=this._position.x*10,this._model.position.y=this._position.y*5,this._model.position.z=this._position.z*10}get position(){return this._position}set position(t){this._position=t,this.updatePosition()}get model(){return this._model}set model(t){this._model=t,this.updatePosition(),this._hasAnimations}get isAnimating(){return this._isAnimating}set isAnimating(t){this._isAnimating=t}}const At=10,Mn=1,Lt=10,In=new ct({color:11984276,flatShading:!0}),Sn=new ct({color:10010486,flatShading:!0}),Cn=r=>{const t=r.getAttribute("position");for(let e=0;e<t.count;e++){const n=new ae;if(n.fromBufferAttribute(t,e),n.y>=.5&&n.x!==-5&&n.x!==5&&n.z!==-5&&n.z!==5){const s=.15-Math.random()*.3,a=At/40-Math.random()*(At/20),o=Lt/40-Math.random()*(Lt/20);t.setXYZ(e,n.x+a,n.y+s,n.z+o)}}r.attributes.position.needsUpdate=!0};class Pn{_tiles=[];_grassLight=new X;_grassDark=new X;_grassAll=new st;constructor(){}add(t){this._tiles.push(t)}reset(){this._tiles=[],this._grassLight=new X,this._grassDark=new X,this._grassAll=new st}create(){const t=[],e=[];if(this._tiles.forEach(n=>{const s=new at(10,1,10,At,Mn,Lt);Cn(s),s.rotateY(v(0,4)*2*(-Math.PI/4)),s.translate(n.position.x*10,-.5+n.position.y*5,n.position.z*10),n.position.x&1&&n.position.z&1||!(n.position.x&1)&&!(n.position.z&1)?t.push(s):e.push(s)}),this._tiles.length){if(t.length){const n=N(t);this._grassLight=new R(n,In),this._grassLight.receiveShadow=!0}if(e.length){const n=N(e);this._grassDark=new R(n,Sn),this._grassDark.receiveShadow=!0}this._grassAll.add(this._grassLight,this._grassDark),this._grassAll.scale.setScalar(0)}return this._grassAll}animateIn(){return this._tiles.length?new Promise(t=>{const e={scale:0},n={scale:1};this.animateUpdate(e),new p.Tween(e).to(n,500).easing(p.Easing.Elastic.InOut).onUpdate(()=>this.animateUpdate(e)).onComplete(t).delay(250).start()}):Promise.resolve()}animateOut(){return this._tiles.length?new Promise(t=>{const e={scale:1},n={scale:0};new p.Tween(e).to(n,500).easing(p.Easing.Elastic.InOut).onUpdate(()=>this.animateUpdate(e)).onComplete(t).delay(1e3).start()}):Promise.resolve()}animateUpdate(t){this._grassAll.scale.setScalar(t.scale)}}const kt=new Pn,On="#ffff00",An=new _(11371131),Ln=new _(10473352),Tn=new _(9157493),Gn=new _(13617032),Dn=new _(13340781),ue=new _(11910596),pe=new _(9542564),me=new _(7964047),ge=new _(5857641);new _(11910596);new _(9542564);new _(7964047);const Rn=new _(5124632),Xn=new _(6307874),Nn=new _(5914664),Un=new _(15658734);new _(16711680);new _(65280);new _(255);const Yn=new _(0),Zn=new _(16751104),Bn=new _(16711680),Fn=new _(65280),U=new ct({flatShading:!0}),$n=new ct({flatShading:!0,transparent:!0,opacity:.75}),Hn=new ct({flatShading:!0,transparent:!0,opacity:.85}),B=new at(1,1,1),vt=new qe(.3,2,4),fe=new Ke(1,0);new at(2,.15,.2);new at(.1,.1,10);const Wn=new at(3,.2,9),jn=new at(.2,.05,.75),Vt=new at(.2,.2,.2),Jt=[Ln,Tn,Gn,Dn],it=new X;class Qn{_tiles=[];_trunk=null;_foliage=null;_trees=new st;_instances=[];constructor(){}add(t){this._tiles.push(t)}reset(){this._tiles=[],this._trunk=null,this._foliage=null,this._trees=new st,this._instances=[]}create(){let t=0;if(this._tiles.forEach(e=>{const n=v(20,30);t+=n;for(let s=0;s<n;s++)this._instances.push({pos:le(-4.75,4.75,e.exclude),rot:{x:lt(-.12,.12),y:lt(-.12,.12),z:0},scale:.5+Math.random()*.75,color:Jt[v(0,Jt.length-1)],tile:e})}),this._tiles.length){this._trunk=new mt(vt.clone(),U,t),this._trunk.castShadow=!0;const e=vt.clone();e.scale(1.3,1.3,1.3),e.translate(0,.5,0);const n=vt.clone();n.scale(1.1,1.1,1.1),n.translate(0,1.1,0);const s=N([e,n]);this._foliage=new mt(s,U,t),this._foliage.castShadow=!0,this._foliage.receiveShadow=!0,this._trunk.geometry.computeBoundingBox(),this._foliage.geometry.computeBoundingBox(),this._trunk.geometry.translate(0,this._trunk.geometry.boundingBox.min.y*-1,0),this._foliage.geometry.translate(0,this._foliage.geometry.boundingBox.min.y*-1,0),this._foliage.geometry.translate(0,.3,0),this._trees.add(this._trunk,this._foliage)}return this._trees}updateInstance(t,e,n){const{pos:s,rot:a,scale:o,color:l,tile:i}=t,{x:d,y:u,z:h}=s,{x:m,y:b,z:I}=a,y=new Ve(m,b,I,"XYZ");it.position.set(d+i.position.x*10,(u+i.position.y*5)*o,h+i.position.z*10),it.setRotationFromEuler(y),it.scale.set(n.x,n.y,n.z),it.updateMatrixWorld(!0),this._trunk.setMatrixAt(e,it.matrixWorld),this._trunk.setColorAt(e,An),it.updateMatrixWorld(!0),this._foliage.setMatrixAt(e,it.matrixWorld),this._foliage.setColorAt(e,l),this._trunk.instanceMatrix.needsUpdate=!0,this._trunk.instanceColor.needsUpdate=!0,this._foliage.instanceMatrix.needsUpdate=!0,this._foliage.instanceColor.needsUpdate=!0}animateIn(){return this._tiles.length?new Promise(t=>{this._instances.forEach((e,n)=>{const{scale:s}=e,a={x:0,y:0,z:0},o={x:s,y:s,z:s};this.updateInstance(e,n,a),new p.Tween(a).to(o,500).easing(p.Easing.Elastic.Out).onUpdate(()=>this.updateInstance(e,n,a)).onComplete(t).delay(v(500,1e3)).start()})}):Promise.resolve()}animateOut(){return this._tiles.length?new Promise(t=>{this._instances.forEach((e,n)=>{const{scale:s}=e,a={x:s,y:s,z:s},o={x:0,y:0,z:0};new p.Tween(a).to(o,500).easing(p.Easing.Elastic.In).onUpdate(()=>this.updateInstance(e,n,a)).onComplete(t).delay(v(500,750)).start()})}):Promise.resolve()}}const zt=new Qn,te=[ue,pe,me,ge],ft=new X;class qn{_tiles=[];_rock=new X;_instances=[];constructor(){}add(t){this._tiles.push(t)}reset(){this._tiles=[],this._rock=new X,this._instances=[]}create(){let t=0;return this._tiles.forEach(e=>{const n=v(6,12);t+=n;for(let s=0;s<n;s++)this._instances.push({pos:le(-4.5,4.5,e.exclude),rot:{x:-.1+Math.random()*.2,y:Math.PI/2*Math.random(),z:-.1+Math.random()*.2},scale:.1+Math.random()*.3,color:te[v(0,te.length-1)],tile:e})}),this._tiles.length&&(this._rock=new mt(fe,U,t),this._rock.castShadow=!0,this._rock.receiveShadow=!0),this._rock}updateInstance(t,e,n){const{pos:s,rot:a,scale:o,color:l,tile:i}=t,{x:d,y:u,z:h}=s,{x:m,y:b,z:I}=a;ft.position.set(d+i.position.x*10,(u+i.position.y+n.y)*o,h+i.position.z*10),ft.rotation.set(m,b,I),ft.scale.set(n.x,n.y,n.z),ft.updateMatrixWorld(!0),this._rock.setMatrixAt(e,ft.matrixWorld),this._rock.setColorAt(e,l),this._rock.instanceMatrix.needsUpdate=!0,this._rock.instanceColor.needsUpdate=!0}animateIn(){return this._tiles.length?new Promise(t=>{this._instances.forEach((e,n)=>{const{scale:s}=e,a={x:0,y:0,z:0},o={x:s,y:s,z:s};this.updateInstance(e,n,a),new p.Tween(a).to(o,500).easing(p.Easing.Elastic.Out).onUpdate(()=>this.updateInstance(e,n,a)).onComplete(t).delay(v(500,1e3)).start()})}):Promise.resolve()}animateOut(){return this._tiles.length?new Promise(t=>{this._instances.forEach((e,n)=>{const{scale:s}=e,a={x:s,y:s,z:s},o={x:0,y:0,z:0};this.updateInstance(e,n,a),new p.Tween(a).to(o,500).easing(p.Easing.Elastic.In).onUpdate(()=>this.updateInstance(e,n,a)).onComplete(t).delay(v(500,750)).start()})}):Promise.resolve()}}const Et=new qn;class we extends Dt{constructor({position:t={x:0,y:0,z:0}}={}){super({position:t});this.create()}create(){kt.add({position:this._position}),zt.add({position:this._position}),Et.add({position:this._position})}}const ee=[Rn,Xn,Nn],Q=new X;class Kn{_tiles=[];_beams=null;_rails=null;_beamInstances=[];_railInstances=[];constructor(){}add(t){this._tiles.push(t)}reset(){this._tiles=[],this._beams=null,this._rails=null,this._beamInstances=[],this._railInstances=[]}create(){const t=new st;let e=0,n=0;if(this._tiles.forEach(s=>{const o=s.direction===2||s.direction===6;e+=11;for(let l=0;l<11;l++)this._beamInstances.push({pos:{x:o?-4.6+l*10/11:0,y:0,z:o?0:-4.6+l*10/11},rot:{x:0,y:-.08+Math.random()*.16+(o?Math.PI/2:0),z:0},color:ee[v(0,ee.length-1)],tile:s});n+=2;for(let l=0;l<2;l++)this._railInstances.push({pos:{x:o?0:-.7+l*1.4,y:.2,z:o?-.7+l*1.4:0},rot:{x:0,y:o?Math.PI/2:0,z:0},color:Un,tile:s})}),this._tiles.length){const s=B.clone();s.scale(2,.3,.3),this._beams=new mt(s,U,e),this._beams.castShadow=!0,this._beams.receiveShadow=!0;const a=B.clone();a.scale(.2,.2,10),this._rails=new mt(a,U,n),this._rails.castShadow=!0,this._rails.receiveShadow=!0,t.add(this._beams,this._rails)}return t}updateBeamInstance(t,e,n){const{pos:s,rot:a,color:o,tile:l}=t,{x:i,y:d,z:u}=s,{x:h,y:m,z:b}=a;Q.position.set(i+l.position.x*10,d+l.position.y*5,u+l.position.z*10),Q.rotation.set(h,m,b),Q.scale.set(n.x,n.y,n.z),Q.updateMatrixWorld(!0),this._beams.setMatrixAt(e,Q.matrixWorld),this._beams.setColorAt(e,o),this._beams.instanceMatrix.needsUpdate=!0,this._beams.instanceColor.needsUpdate=!0}updateRailInstance(t,e,n){const{pos:s,rot:a,color:o,tile:l}=t,{x:i,y:d,z:u}=s,{x:h,y:m,z:b}=a;Q.position.set(i+l.position.x*10,d+n.y+l.position.y*10,u+l.position.z*10),Q.rotation.set(h,m,b),Q.scale.set(n.scale,n.scale,n.scale),Q.updateMatrixWorld(!0),this._rails.setMatrixAt(e,Q.matrixWorld),this._rails.setColorAt(e,o),this._rails.instanceMatrix.needsUpdate=!0,this._rails.instanceColor.needsUpdate=!0}animateIn(){return this._tiles.length?new Promise(t=>{this._beamInstances.forEach((e,n)=>{const s={x:0,y:0,z:0},a={x:1,y:1,z:1};this.updateBeamInstance(e,n,s),new p.Tween(s).to(a,500).easing(p.Easing.Elastic.Out).onUpdate(()=>this.updateBeamInstance(e,n,s)).delay(v(750,1e3)).start()}),this._railInstances.forEach((e,n)=>{const s={y:5,scale:0},a={y:0,scale:1};this.updateRailInstance(e,n,s),new p.Tween(s).to(a,500).easing(p.Easing.Elastic.Out).onUpdate(()=>this.updateRailInstance(e,n,s)).onComplete(t).delay(v(750,1e3)).start()})}):Promise.resolve()}animateOut(){return this._tiles.length?new Promise(t=>{this._beamInstances.forEach((e,n)=>{const s={x:1,y:1,z:1},a={x:0,y:0,z:0};new p.Tween(s).to(a,500).easing(p.Easing.Elastic.In).onUpdate(()=>this.updateBeamInstance(e,n,s)).delay(v(750,1e3)).start()}),this._railInstances.forEach((e,n)=>{const s={y:0,scale:1},a={y:5,scale:0};new p.Tween(s).to(a,500).easing(p.Easing.Elastic.In).onUpdate(()=>this.updateRailInstance(e,n,s)).onComplete(t).delay(v(750,1e3)).start()})}):Promise.resolve()}}const ye=new Kn;class Tt extends Dt{_tiles=[];_direction=0;constructor({position:t={x:0,y:0,z:0},direction:e=0}={}){super({position:t});this._direction=e,this.create()}create(){kt.add({position:this._position}),zt.add({position:this._position,exclude:{width:3,direction:this._direction}}),Et.add({position:this._position,exclude:{width:3,direction:this._direction}}),ye.add({position:this._position,direction:this._direction})}}var Vn="/atc-gjk/assets/helvetiker_regular.typeface.d5c54676.json",Jn="/atc-gjk/assets/helvetiker_bold.typeface.bd68159e.json";const ts=new Je,es=async r=>new Promise((t,e)=>{ts.load(r,n=>t(n),null,n=>e(n))}),ns=[Vn,Jn],_e=await Promise.all(ns.map(async r=>await es(r)));_e[0];const be=_e[1],ve=U.clone();ve.color.set(Yn);const xe=U.clone();xe.color.set(Zn);const ke=U.clone();ke.color.set(Fn);const ze=U.clone();ze.color.set(Bn);const Ee=U.clone();Ee.color.set(On);class ss{_tiles=[];_airstrip=null;_strips=null;_stripes=null;_greenLights=null;_redLights=null;_label=null;constructor(){}add(t){this._tiles.push(t)}reset(){this._tiles=[],this._airstrip=null,this._strips=null,this._stripes=null,this._greenLights=null,this._redLights=null,this._label=null}create(){this._airstrip=new st;const t=[],e=[],n=[],s=[],a=[];if(this._tiles.forEach((o,l)=>{const i=Wn.clone();i.rotateY(o.direction*Math.PI/-4),i.translate(o.position.x*10,.1+o.position.y*5,o.position.z*10),t.push(i);for(let u=0;u<7;u++){const h=jn.clone();h.translate(0,0,-3+u),h.rotateY(o.direction*Math.PI/-4),h.translate(o.position.x*10,.2+o.position.y*5,o.position.z*10),e.push(h)}for(let u=0;u<5;u++){const h=Vt.clone();h.translate(-1+u*.5,0,4),h.rotateY(o.direction*Math.PI/-4),h.translate(o.position.x*10,o.position.y*5,o.position.z*10),n.push(h);const m=Vt.clone();m.translate(-1+u*.5,0,-4),m.rotateY(o.direction*Math.PI/-4),m.translate(o.position.x*10,o.position.y*5,o.position.z*10),s.push(m)}const d=new oe(`AP${l+1}`,{font:be,size:80,height:5,curveSegments:12,bevelEnabled:!0,bevelThickness:10,bevelSize:3,bevelOffset:0,bevelSegments:5});d.center(),d.scale(.01,.01,.01),d.translate(0,-3,0),d.rotateX(Math.PI/-2),d.rotateY(o.direction*Math.PI/-4),d.translate(o.position.x*10,.2+o.position.y*5,o.position.z*10),a.push(d)}),this._tiles.length){const o=N(t),l=N(e),i=N(n),d=N(s),u=N(a);this._strips=new R(o,ve),this._stripes=new R(l,xe),this._greenLights=new R(i,ke),this._redLights=new R(d,ze),this._labels=new R(u,Ee),this._greenLights.position.y=.2,this._redLights.position.y=.2,this._airstrip.add(this._strips,this._stripes,this._greenLights,this._redLights,this._labels)}return this._airstrip}animateIn(){return this._tiles.length?new Promise(t=>{const e={scale:0},n={scale:1};this.animateUpdate(e),new p.Tween(e).to(n,500).easing(p.Easing.Elastic.InOut).onUpdate(()=>this.animateUpdate(e)).onComplete(t).delay(1e3).start()}):Promise.resolve()}animateOut(){return this._tiles.length?new Promise(t=>{const e={scale:1},n={scale:0};new p.Tween(e).to(n,500).easing(p.Easing.Elastic.InOut).onUpdate(()=>this.animateUpdate(e)).onComplete(t).delay(1e3).start()}):Promise.resolve()}animateUpdate(t){this._airstrip.scale.setScalar(t.scale)}}const Rt=new ss;class Me extends Dt{_tiles=[];_direction=0;constructor({position:t={x:0,y:0,z:0},direction:e=0}={}){super({position:t});this._direction=e,this.create()}create(){kt.add({position:this._position}),zt.add({position:this._position,exclude:{width:5.5,direction:this._direction}}),Et.add({position:this._position,exclude:{width:5.5,direction:this._direction}}),Rt.add({position:this._position,direction:this._direction})}}const ne=[ue,pe,me,ge],ut=new X;class as{_tiles=[];_clouds=new X;_animate=()=>{};_instances=[];_tick=0;constructor(){}add(t){this._tiles.push(t)}reset(){this._tiles=[],this._clouds=new X,this._animate=()=>{},this._instances=[],this._tick=0}create(){let t=0;return this._tiles.forEach(e=>{const n=v(8,12);t+=n;const s=ne[v(0,ne.length-1)],a=v(5,9);for(let o=0;o<n;o++)this._instances.push({pos:{x:-3+Math.random()*6,y:-.2+Math.random()*.4,z:-3+Math.random()*6},rot:{x:Math.PI*2*Math.random(),y:Math.PI*2*Math.random(),z:Math.PI*2*Math.random()},altitude:e.position.y||a,animation:{direction:Math.random()>.5?1:-1,speed:v(200,300)},scale:.5+Math.random()*1.5,color:s,isReady:!1,tile:e})}),this._clouds=new mt(fe,Hn,t),this._animate=()=>{this._instances.forEach((e,n)=>{const{isReady:s}=e;s&&this.updateInstance(e,n)}),this._tick++},this._clouds}updateInstance(t,e,n){const{pos:s,rot:a,scale:o,color:l,animation:i,tile:d,altitude:u}=t,{x:h,y:m,z:b}=s,{x:I,y,z:f}=a,{direction:g,speed:C}=i,Y=Math.sin((this._tick+e*50)/10/Math.PI)/20;ut.position.set(h+d.position.x*10,u*5+(m+Y)*o,b+d.position.z*10),ut.rotation.set(I,y,f+this._tick/C*g),n?ut.scale.set(n.x,n.y,n.z):ut.scale.setScalar(o),ut.updateMatrixWorld(!0),this._clouds.setMatrixAt(e,ut.matrixWorld),this._clouds.setColorAt(e,l),this._clouds.instanceMatrix.needsUpdate=!0,this._clouds.instanceColor.needsUpdate=!0}animateIn(){return this._tiles.length?new Promise(t=>{this._instances.forEach((e,n)=>{const{scale:s}=e,a={x:0,y:0,z:0},o={x:s,y:s,z:s};this.updateInstance(e,n,a),new p.Tween(a).to(o,500).easing(p.Easing.Elastic.Out).onUpdate(()=>this.updateInstance(e,n,a)).onComplete(()=>{e.isReady=!0,t()}).delay(v(1e3,1250)).start()})}):Promise.resolve()}animateOut(){return this._tiles.length?new Promise(t=>{this._instances.forEach((e,n)=>{const{scale:s}=e,a={x:s,y:s,z:s},o={x:0,y:0,z:0};this.updateInstance(e,n,a),new p.Tween(a).to(o,500).easing(p.Easing.Elastic.In).onStart(()=>e.isReady=!1).onUpdate(()=>this.updateInstance(e,n,a)).onComplete(t).delay(v(250,500)).start()})}):Promise.resolve()}}const wt=new as,os=new _(16777215),is=r=>{const t=B.clone();t.scale(1,1,2),z(0,t,-.2,-.1),z(2,t,-.2,.3),z(4,t,.2,-.1),z(6,t,.2,.3);const e=B.clone();e.scale(3,.1,1),z(1,e,.2,.05),z(3,e,.2,-.05),z(5,e,-.2,.05),z(7,e,-.2,-.05);const n=B.clone();n.scale(.1,.75,.5),n.translate(0,.5,.95),z(0,n,-.04,.05),z(2,n,-.04),z(3,n,0,-.05),z(4,n,.04,.05),z(6,n,.04),z(7,n,0,-.05);const s=B.clone();s.scale(.4,.5,.6);const a=s.clone();a.translate(0,-.3,.6),a.rotateX(-.2);const o=s.clone();o.translate(.3,-.3,-.65);const l=s.clone();l.translate(-.3,-.3,-.65);const i=N([t,e,n,a,o,l]),d=B.clone();d.scale(.7,.4,.05),d.translate(0,.5,-.7),d.rotateX(.2),z(0,d,-.05),z(1,d,-.05),z(4,d,.05),z(5,d,.05);const u=N([d]),h=B.clone();h.scale(1,1,.5),h.translate(0,0,-1.25),z(1,h,-.1,-.1),z(3,h,-.1,.1),z(5,h,.1,-.1),z(7,h,.1,.1);const m=B.clone();m.scale(.1,.1,.5),z(2,m,null,null,.01),z(1,m,null,null,-.009),z(3,m,null,null,-.009),z(7,m,null,null,-.01);const b=m.clone();b.rotateZ(Math.PI/4),b.rotateY(.2),b.translate(.5,.2,-1.05);const I=m.clone();I.rotateZ(Math.PI/4),I.translate(.55,.2,-.55);const y=m.clone();y.rotateZ(Math.PI/4)+Math.PI/2,y.rotateY(-.2),y.translate(-.5,.2,-1.05);const f=m.clone();f.rotateZ(Math.PI/4),f.translate(-.55,.2,-.55);const g=N([h,b,I,y,f]),C=B.clone();C.scale(.2,.2,.2),C.translate(0,0,-1.55),z(0,C,.07,.07),z(2,C,.07,-.07),z(4,C,-.07,.07),z(6,C,-.07,-.07);const Y=B.clone();Y.scale(.2,.4,.4);const H=Y.clone();H.translate(0,-.6,.6),H.rotateX(-.2);const F=Y.clone();F.translate(-.3,-.6,-.65);const K=Y.clone();K.translate(.3,-.6,-.65);const gt=N([C,H,F,K]),dt=B.clone();dt.scale(.15,1.5,.05),dt.translate(0,0,-1.6);const A=dt.clone();A.rotateZ(Math.PI/2);const $=N([dt,A]),ot=B.clone();ot.scale(.34,.2,.2);const tt=ot.clone();tt.translate(0,-.6,.6),tt.rotateX(-.2);const ht=ot.clone();ht.translate(-.3,-.6,-.65);const yt=ot.clone();yt.translate(.3,-.6,-.65);const Ce=N([tt,ht,yt]),_t=vt.clone();_t.scale(1.2,.42,1.2),_t.rotateX(Math.PI),_t.translate(0,2,0);const Pe=N([_t]),Mt=new st;Mt.name="plane";const It=U.clone();It.color.set(r),It.name="base";const Xt=$n.clone(),Nt=U.clone(),Ut=U.clone(),St=U.clone(),Yt=U.clone(),Oe=new _(14872564),Ae=new _(0),Le=new _(10053706),Te=new _(16777215),Ge=new _(65280);Xt.color.set(Oe),Nt.color.set(Te),Ut.color.set(Le),St.color.set(Ae),Yt.color.set(Ge);const De=new R(i,It),Re=new R(u,Xt),Xe=new R(g,Nt),Ne=new R(gt,St),Zt=new R($,St);Zt.name="props";const Ue=new R(Ce,Ut),Ct=new R(Pe,Yt);return Ct.name="selector",Ct.visible=!1,Mt.add(De,Re,Xe,Ne,Zt,Ue,Ct),Mt};class Ie{_startTime=0;_position={x:0,y:0,z:0};_direction=0;_targetAltitude=0;_targetDirection=0;_start=null;_end=null;_spawned=!1;_takenOff=!1;_landed=!1;_isGhost=!1;_isSelected=!1;_name="";_id=null;_color=null;_model=null;_tick=0;_fuel=0;_flightStatus=L.SCHEDULED;constructor(t){const{id:e,start:n,end:s,fuel:a,startTime:o}=t;return this._start=n,this._end=s,this._position=n.position,this._direction=n.direction,this._targetAltitude=this._position.y||1,this._takenOff=this._position.y!==0,this._id=e,this._name="GJK",this._color=new _(Math.random()*16777215),this._fuel=a,this._startTime=o,this.create(),this}animate=()=>this.animateIdle();updateAnimation(t){this._model.position.x=t.position.x*10,this._model.position.y=t.position.y*5,this._model.position.z=t.position.z*10,this._model.scale.setScalar(t.scale)}animateIn(t=1250,e=500){return new Promise(n=>{const{_position:s,_direction:a}=this;let o,l;this._takenOff?(o={position:vn({...s},a),direction:a,scale:0},l={position:{...s},direction:a,scale:1}):(o={position:{...s},direction:a,scale:0},l={position:{...s},direction:a,scale:1},o.position.y=.18,l.position.y=.18),this.updateAnimation(o),new p.Tween(o).to(l,e).easing(p.Easing.Elastic.Out).onUpdate(()=>this.updateAnimation(o)).onComplete(n).delay(t).start()})}animateOut(t=0,e=500){return new Promise(n=>{const{_position:s,_direction:a}=this,o={position:{x:this._model.position.x/10,y:this._model.position.y/5,z:this._model.position.z/10},direction:this._direction,scale:1},l={position:Pt(s,a),direction:this._direction,scale:0};this.updateAnimation(o),new p.Tween(o).to(l,e).easing(p.Easing.Elastic.In).onUpdate(()=>this.updateAnimation(o)).onComplete(n).delay(t).start()})}animateIdle(){const t=Math.sin(this._tick/10/Math.PI)/100,e=Math.sin(this._tick/15/Math.PI)/10,n=Math.sin(this._tick/20/Math.PI)/20;this._position.y>=1&&(this._model.position.y+=t,this._model.rotation.z=e,this._model.rotation.x=n),this._model.children.forEach(s=>{s.name==="props"&&(s.rotation.z+=.3),s.name==="selector"&&(s.rotation.y+=.01,s.position.y+=t)}),this._tick++}create(){const t=is(this._color);t.position.x=this._position.x*10,t.position.z=this._position.z*10,t.position.y=this._position.y*5,t.rotation.y=this._direction*(Math.PI/-4),this._takenOff||t.rotateX(.1),t._id=this._id,this._model=t}async next(t=0,e=1){const n=Pt(this._position,this._direction);let s=0,a=0;this._targetAltitude>this._position.y?s=1:this._targetAltitude<this._position.y&&(s=-1),this._targetDirection>0?(this._targetDirection--,a=1):this._targetDirection<0&&(this._targetDirection++,a=-1),await this.animateNext(s,a,t,e,this._takenOff?0:.1),this.unsetGhost(),this._takenOff=!0,this._flightStatus=L.IN_FLIGHT,n.y+=s,this._position=n,this._direction=(8+(this._direction+a))%8,this._model.rotation.y=this._direction*(Math.PI/-4),this._fuel-=1}async animateNext(t,e,n=0,s=1){return new Promise(a=>{const o={position:{x:this._model.position.x/10,y:this._model.position.y/5,z:this._model.position.z/10},direction:this._model.rotation.y,scale:s},l=Pt(this._position,this._direction);l.y+=t,l.y===0&&(l.y=.18);const i={position:l,direction:this._model.rotation.y+e*Math.PI/-4,scale:1};new p.Tween(o).to(i,500).easing(p.Easing.Cubic.InOut).onUpdate(()=>this.updateAnimation(o,this._targetDirection>0)).onComplete(a).delay(n).start()})}setGhost(){this._isGhost=!0,this._model.children.forEach(t=>{t.material.name==="base"&&t.material.color.set(os),t.material&&t.material.name!=="selector"&&(t.material.transparent=!0,t.material.opacity=.75,t.material.needsUpdate=!0)})}unsetGhost(){this._isGhost=!1,this._model.children.forEach(t=>{t.material.name==="base"&&t.material.color.set(this._color),t.material&&t.material.name!=="selector"&&(t.material.transparent=!1,t.material.opacity=1,t.material.needsUpdate=!0)})}setSpawned(){this._spawned=!0,this._flightStatus=L.APPROACHING}setExited(){this._flightStatus=L.EXITED}setLanded(){this._flightStatus=L.LANDED}setLost(){this._flightStatus=L.LOST}setCrashed(){this._flightStatus=L.CRASHED}setSelected(){this._isSelected=!0,this._model.children.forEach(t=>{t.name==="selector"&&(t.visible=!0)})}unsetSelected(){this._isSelected=!1,this._model.children.forEach(t=>{t.name==="selector"&&(t.visible=!1)})}setHeight(t){this._targetAltitude=t}setDirection(t){this._targetDirection=t}}const rs=new ct({color:3900150,flatShading:!0});class ls{_tiles=[];_labels=new st;constructor(){}add(t={position:{x:1,y:1,z:1},direction:0,text:"N"}){this._tiles.push(t)}reset(){this._tiles=[]}create(){return this._tiles.forEach(t=>{const e=new oe(t.text,{font:be,size:80,height:5,curveSegments:12,bevelEnabled:!0,bevelThickness:10,bevelSize:3,bevelOffset:0,bevelSegments:5});e.center(),e.scale(.03,.03,.03),e.rotateX(Math.PI/-2),e.rotateY(t.direction*Math.PI/-4),e.translate(t.position.x*10,-.5+t.position.y*5,t.position.z*10),this._labels.add(new R(e,rs))}),this._labels}animateIn(){return this._tiles.length?new Promise(t=>{const e={scale:0},n={scale:1};this.animateUpdate(e),new p.Tween(e).to(n,500).easing(p.Easing.Elastic.InOut).onUpdate(()=>this.animateUpdate(e)).onComplete(t).delay(0).start()}):Promise.resolve()}animateOut(){return this._tiles.length?new Promise(t=>{const e={scale:1},n={scale:0};new p.Tween(e).to(n,500).easing(p.Easing.Elastic.InOut).onUpdate(()=>this.animateUpdate(e)).onComplete(t).delay(1250).start()}):Promise.resolve()}animateUpdate(t){this._labels.scale.setScalar(t.scale)}}const V=new ls,se=r=>{r.dispose();for(const t of Object.keys(r)){const e=r[t];e&&typeof e=="object"&&"minFilter"in e&&e.dispose()}};class Se{_scene=null;_anims=[];_lights=[];_models=[];_fog=null;_elements=[V,Gt,kt,zt,Et,wt,Rt,ye];_airplanes=et([]);_board=null;_tick=et(-1);_tickWatcher=null;_isAnimating=!1;_score=et(0);_animate=()=>{wt._animate(),this._airplanes.value.forEach(t=>t?.animate())};constructor(){this._scene=new Bt,this._tickWatcher=pt(this._tick,t=>{t>=96&&(M.send("WIN"),this._tickWatcher())})}addLight(t){this._lights.push(t)}addFog(t){this._fog=t}addBoard(t){this._board=t}addAirplane(t){this._airplanes.value.push(t),this._scene.add(t._model)}removeAirplane(t){this._airplanes.value=this._airplanes.value.filter(n=>n._id!==t._id);const e=this._scene.getObjectById(t._model.id);this._scene.remove(e)}reset(){this._scene.traverse(t=>{if(!!t.isMesh)if(t.geometry.dispose(),t.material.isMaterial)se(t.material);else for(const e of t.material)se(e)}),this._scene=new Bt,this._anims=[],this._lights=[],this._models=[],this._fog=null,this._airplanes.value=[],this._tick.value=-1,this._score.value=0,this._elements.forEach(t=>t.reset())}async animateIn(){return await Promise.all([...this._elements,...this._airplanes.value].map(t=>t.animateIn())),Promise.resolve()}async animateOut(){return await Promise.all([...this._elements,...this._airplanes.value].map(t=>t.animateOut())),Promise.resolve()}render(){this._scene.fog=this._fog,this._lights.forEach(t=>{this._scene.add(t)}),this._elements.forEach(t=>this._scene.add(t.create()))}}const cs=[we,Tt,Me],ds=q(cs);class hs extends Se{start=()=>{const t=new ie(16777215,526338,.7);t.position.set(15,25,15);const e=new X;e.rotation.x=Math.PI/-3;const n=new xt(16777215,.3);e.add(n),n.position.set(60,0,0),n.lookAt(e.position),n.castShadow=!0,n.shadow.mapSize.width=2048,n.shadow.mapSize.height=2048,n.shadow.camera.near=.5,n.shadow.camera.far=500,n.shadow.camera.top=90,n.shadow.camera.bottom=-120,n.shadow.camera.left=-90,n.shadow.camera.right=90,e.rotation.y=Math.PI/-1.5;const s=new xt(11592173,.2);s.position.set(-20,25,-10),this.addLight(t),this.addLight(e),this.addLight(s),new ds;const a=new Ie({id:0,start:{position:{x:0,y:1,z:0},direction:1,name:""},end:{position:{x:0,y:0,z:0},direction:1,name:""},fuel:100});this.addAirplane(a),Gt.add(),wt.add({position:{x:0,y:2,z:0}});const o=new re(new _(10209513),15,30);this.addFog(o);const l=new X;l.position.y=2.5,E.target=l.position}}class us{_width=0;_depth=0;_difficulty=null;_airfields=0;_clouds=0;_airplanes=0;_airplanesQueue=[];_tiles=[];_tick=0;constructor(t=1){this._difficulty=he[t],this._width=Qt[this._difficulty].width,this._depth=Qt[this._difficulty].depth,this._airfields=v(qt[this._difficulty].min,qt[this._difficulty].max),this._clouds=v(Kt[this._difficulty].min,Kt[this._difficulty].max),this._airplanes=Ot[this._difficulty].amount}generate(){const t=Math.ceil(0-this._width/2),e=Math.ceil(0-this._depth/2),n=Math.abs(t),s=Math.abs(e);this._tiles=Array.from({length:this._depth},()=>Array.from({length:this._width},()=>null));const a=Math.random()>.5,o=q(a?[0,1,this._depth-1,this._depth-2]:[0,1,this._width-1,this._width-2]);a?this._tiles[o].forEach((i,d)=>{this._tiles[o][d]=new Tt({position:{x:d+t,y:0,z:o+e},direction:2})}):this._tiles.forEach((i,d)=>{this._tiles[d][o]=new Tt({position:{x:o+t,y:0,z:d+e}})});const l=[];for(let i=0;i<this._airfields;i++){const d=yn(this._tiles,this._width,this._depth,3);if(d){const{x:u,z:h,tile:m}=d,b={position:m,direction:v(0,7),name:`AP${l.length+1}`};l.push(b),this._tiles[h][u]=new Me(b)}}this._tiles.forEach((i,d)=>{i.forEach((u,h)=>{if(!u)return new we({position:{x:h+t,y:0,z:d+e}})})}),Gt.add({scale:{x:this._width,y:1,z:this._depth}});for(let i=0;i<this._clouds;i++)wt.add({position:{x:v(t,s),y:v(Ot[this._difficulty].height-2,Ot[this._difficulty].height),z:v(e,s)}});for(let i=0;i<this._airplanes;i++){const d=xn(this._width,this._depth,l);let u=jt(this._width,this._depth,l);for(;d.name===u.name;)u=jt(this._width,this._depth,l);this._airplanesQueue.push(new Ie({id:tn(),start:d,end:u,startTime:v(0,96),fuel:v(20,35)}))}V.add({position:{x:0,y:0,z:e-2},direction:0,text:"N"}),V.add({position:{x:n+1,y:0,z:e-1},direction:1,text:"NE"}),V.add({position:{x:n+2,y:0,z:0},direction:2,text:"E"}),V.add({position:{x:n+1,y:0,z:s+1},direction:3,text:"SE"}),V.add({position:{x:0,y:0,z:s+2},direction:4,text:"S"}),V.add({position:{x:t-1,y:0,z:s+1},direction:5,text:"SW"}),V.add({position:{x:t-2,y:0,z:0},direction:6,text:"W"}),V.add({position:{x:t-1,y:0,z:e-1},direction:7,text:"NW"}),this._airplanesQueue.sort((i,d)=>i._startTime<d._startTime?-1:i._startTime>d._startTime?1:0)}}class ps extends Se{start=()=>{const t=new ie(16777215,526338,.7);t.position.set(15,25,15);const e=new X;e.name="sun";const n=new xt(16777215,.3),s=new Ft(n,5);e.add(n),n.position.set(0,60,0),n.castShadow=!0,n.shadow.mapSize.width=2048,n.shadow.mapSize.height=2048,n.shadow.camera.near=.5,n.shadow.camera.far=500,n.shadow.camera.top=90,n.shadow.camera.bottom=-120,n.shadow.camera.left=-90,n.shadow.camera.right=90;const a=new xt(11592173,.2),o=new Ft(a,5);a.position.set(-20,25,-10);const l=new X;l.position.y=2.5,E.target=l.position,this.addLight(t),this.addLight(e),this.addLight(s),this.addLight(o),this.addLight(a);const i=new re(new _(10209513),15,350);e.rotation.x=Math.PI/4,e.rotation.z=Math.PI;const d=new us(M.state.context.difficulty);d.generate(),this.addFog(i),this.addBoard(d),this.nextTick()};nextTick=async()=>{if(!this._isAnimating){this._isAnimating=!0,this._tick.value++,this._airplanes.value=this._airplanes.value.filter(s=>{if(s._flightStatus===L.LANDED||s._flightStatus===L.EXITED||s._flightStatus===L.LOST)this.removeAirplane(s);else return s});const t=Promise.all(this._airplanes.value.map(s=>s.next())),e=Promise.all(this._board._airplanesQueue.filter(s=>s._startTime===this._tick.value).map(s=>(this.addAirplane(s),s.setSpawned(),s.setGhost(),s.animateIn(0,500)))),n=new Promise(s=>{const a=this._lights.find(i=>i.name==="sun"),o={rot:a.rotation.z},l={rot:a.rotation.z+Math.PI*2*(1/96)};new p.Tween(o).to(l,500).easing(p.Easing.Quadratic.InOut).onUpdate(()=>a.rotation.z=o.rot).onComplete(s).start()});await t,await e,await n,this.checkObstructions(),this.checkDestinations(),this.checkOutOfBounds(),this.checkOutOfFuel(),this._isAnimating=!1}};checkObstructions=()=>{const t=0-Math.floor(this._board._width/2),e=0-Math.floor(this._board._depth/2),n=Math.abs(t),s=Math.abs(e);this._airplanes.value.forEach(a=>{const{x:o,y:l,z:i}=a._position;let d=!1,u=!1;wt._tiles.forEach(h=>{const{x:m,y:b,z:I}=h.position;m===o&&b===l&&I===i&&(d=!0)}),(o<t||o>n||i<e||i>s)&&(u=!0),(d||u)&&a.setGhost()})};checkCollisions=()=>{this._airplanes.value.forEach(t=>{const{x:e,y:n,z:s}=t._position;t._takenOff&&(n===0&&Rt._tiles.forEach(a=>{const{x:o,y:l,z:i}=a.position;e===o&&s===i&&t._direction===a.direction?console.log("plane landed on airport, check if it's the right airport!"):(console.log(`plane crashed at ${o}, ${l}, ${i}`),M.send("LOSE"))}),this._airplanes.value.forEach(a=>{if(t._id!==a._id){const{x:o,y:l,z:i}=a._position;e===o&&n===l&&s===i&&M.send("LOSE")}}))})};checkDestinations=()=>{this._airplanes.value.forEach(t=>{if(t._takenOff){const{x:e,y:n,z:s}=t._position,a=t._direction,{position:{x:o,y:l,z:i},direction:d}=t._end;e===o&&n===l&&s===i&&a===d?(this._score.value+=100+t._fuel*10,t.setGhost(),n===0?t.setLanded():t.setExited()):n===0&&(console.log("game over!"),t.setCrashed(),M.send("LOSE"))}})};checkOutOfBounds=()=>{this._airplanes.value.forEach(t=>{const{x:e,z:n}=t._position,s=0-Math.ceil(this._board._width/2),a=0-Math.ceil(this._board._depth/2),o=Math.abs(s),l=Math.abs(a);(e<=s||e>=o||n<=a||n>=l)&&t._flightStatus!==L.APPROACHING&&t._startTime<this._tick.value&&(this._score.value-=500,t.setLost())})};checkOutOfFuel=()=>{this._airplanes.value.forEach(t=>{t._fuel<=0&&(console.log("game over!"),M.send("LOSE"))})};selectPlane=t=>{this._airplanes.value.forEach(e=>{if(e._id===t&&e._isSelected){e.unsetSelected();return}e.unsetSelected(),e._id===t&&!e._isGhost&&e.setSelected()})}}const P={props:{size:{type:String,default:"md"},isDisabled:{type:Boolean,default:!1},isPrimary:{type:Boolean,default:!1},isSecondary:{type:Boolean,default:!1}},setup(r){const t=r,{size:e,isDisabled:n,isPrimary:s,isSecondary:a}=en(t),o=nt(()=>{switch(e.value){case"control":return["w-7 min-h-7"];case"xs":return[];case"md":default:return[]}}),l=nt(()=>{const u=["blur-[2px]",!s.value&&!a.value&&"bg-gray-800",s.value&&"bg-blue-800",a.value&&"bg-blue-600"];switch(e.value){case"control":return[...u,"rounded-sm translate-y-[1px] group-active:translate-y-[0px] group-hover:translate-y-[2px]"];case"xs":return[...u,"rounded translate-y-[2px] group-active:translate-y-[1px] group-hover:translate-y-[4px]"];case"sm":return[...u,"rounded translate-y-[2px] group-active:translate-y-[1px] group-hover:translate-y-[4px]"];case"md":default:return[...u,"rounded translate-y-[2px] group-active:translate-y-[1px] group-hover:translate-y-[4px]"]}}),i=nt(()=>{const u=[!s.value&&!a.value&&"group-hover:bg-gray-300",s.value&&"bg-blue-800 group-hover:bg-blue-900",a.value&&"bg-blue-400 group-hover:bg-blue-500"];switch(e.value){case"control":return[...u,"w-7 min-h-7 p-[2px] rounded-sm"];case"xs":return[...u,"py-1 px-1 rounded"];case"sm":return[...u,"py-2 px-5 rounded"];case"md":default:return[...u,"py-3 px-7 rounded"];case"lg":return[...u,"py-4 px-8 rounded"]}}),d=nt(()=>{const u=[!s.value&&!a.value&&!n.value&&"text-gray-800 group-hover:bg-gray-100",n.value&&"bg-gray-200 border-gray-200 text-gray-400 cursor-not-allowed",s.value&&"bg-blue-500 border-blue-700 text-white group-hover:bg-blue-600",a.value&&"bg-blue-200 border-blue-300 text-blue-700 group-hover:bg-blue-300"];switch(e.value){case"control":return[...u,!n.value&&"group-active:-translate-y-[0px] group-hover:-translate-y-[3px]","absolute inset-0 border rounded-sm text-xs -translate-y-[1px]"];case"xs":return[...u,!n.value&&"group-active:-translate-y-[0px] group-hover:-translate-y-[6px]","py-1 px-1 text-xs rounded -translate-y-[4px] group-active:-translate-y-[2px] group-hover:-translate-y-[6px]"];case"sm":return[...u,!n.value&&"group-active:-translate-y-[0px] group-hover:-translate-y-[6px]","py-2 px-5 text-sm rounded -translate-y-[4px] group-active:-translate-y-[2px] group-hover:-translate-y-[6px]"];case"md":default:return[...u,!n.value&&"group-active:-translate-y-[0px] group-hover:-translate-y-[6px]","py-2 px-7 text-sm rounded -translate-y-[4px] group-active:-translate-y-[2px] group-hover:-translate-y-[6px]"];case"lg":return[...u,!n.value&&"group-active:-translate-y-[0px] group-hover:-translate-y-[6px]","py-3 px-8 text-xl rounded -translate-y-[4px] group-active:-translate-y-[2px] group-hover:-translate-y-[6px]"]}});return(u,h)=>(G(),D("button",{class:rt(["relative group select-none",w(o)])},[c("span",{class:rt(["absolute inset-0 bg-opacity-50 transition-transform transform",w(l)])},null,2),c("span",{class:rt(["absolute inset-0 bg-gray-200",w(i)])},null,2),c("span",{class:rt(["flex justify-center items-center bg-white font-bold transition-all transform",w(d)])},[nn(u.$slots,"default")],2)],2))}};const ms=c("div",{id:"three"},null,-1),gs={class:""},fs={key:0,class:"absolute top-32 left-1/2 transform -translate-x-1/2"},ws=c("h1",{class:"font-callout text-6xl stage"},[c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("div",{class:"layer"}),c("span",{class:"opacity-0"},"Air Traffic Control")],-1),ys=[ws],_s={key:0,class:"fixed bottom-1/4 left-1/2 transform -translate-x-1/2"},bs=S(" Play "),vs={key:0,class:"fixed top-3 right-2"},xs={key:0,class:"fixed top-2 left-1/2 transform -translate-x-1/2 bg-white rounded shadow-block origin-top"},ks={class:"pt-2 pb-3 px-4 text-center text-sm"},zs=c("div",{class:"font-bold text-gray-800"}," Score ",-1),Es={key:0,class:"fixed top-2 right-2 text-xs font-bold origin-top-right"},Ms={class:"absolute -bottom-16 left-1/2 w-16 transform -translate-x-1/2 bg-white pt-2 pb-3 px-3 rounded shadow-block text-center"},Is=c("div",{class:"font-bold text-sm"}," Time ",-1),Ss={class:"text-blue-500"},Cs={key:0,class:"fixed bottom-2 right-2 w-80 bg-white rounded shadow-block origin-bottom-right"},Ps={class:"p-2 pb-3 text-center"},Os=c("div",{class:"font-bold text-sm text-gray-800"}," Flight Schedule ",-1),As={class:"space-y-1 max-h-48 overflow-auto mt-2"},Ls={class:"text-sm font-bold w-full"},Ts=c("thead",null,[c("tr",{class:"sticky top-0 bg-white bg-opacity-80"},[c("th",{class:"font-bold text-sm text-gray-700"}," Time "),c("th",{class:"font-bold text-sm text-gray-700"}," Status "),c("th",{class:"font-bold text-sm text-gray-700"}," Entry "),c("th",{class:"font-bold text-sm text-gray-700"}," Exit "),c("th",{class:"font-bold text-sm text-gray-700"}," Fuel ")])],-1),Gs={class:"text-xs"},Ds=["onClick"],Rs={class:"py-1"},Xs={class:"py-1"},Ns={class:"py-1"},Us={class:"py-1"},Ys={class:"py-1"},Zs={key:0,class:"fixed top-3 left-2 origin-top-left"},Bs=S(" Quit "),Fs={class:"fixed bottom-2 left-2 bg-white rounded shadow-block origin-bottom-left"},$s={class:"p-2 pb-3 text-center"},Hs=c("div",{class:"font-bold text-sm text-gray-800"}," Flight Controls ",-1),Ws={class:"flex"},js={class:"p-2 space-y-1"},Qs=c("div",{class:"font-bold text-sm text-gray-700"}," Direction ",-1),qs={class:"grid grid-cols-3 gap-1"},Ks=S(" 45 "),Vs=S(" \u2191 "),Js=S(" 45 "),ta=S(" 90 "),ea=S(" 90 "),na=S(" 135 "),sa=S(" L "),aa=S(" 135 "),oa=S(" 180 "),ia=S(" \u221E "),ra=S(" 180 "),la={class:"p-2 space-y-1"},ca=c("div",{class:"font-bold text-sm text-gray-700"}," Altitude ",-1),da={class:"grid grid-cols-3 gap-1"},ha={key:0,class:"fixed z-50 inset-0 flex items-center justify-center"},ua={class:"relative z-10 p-6 pb-7 rounded bg-white shadow-block"},pa=c("h2",{class:"text-base font-bold"}," Are you sure you want to quit? ",-1),ma={class:"flex space-x-4 items-center justify-center mt-6"},ga=S(" No "),fa=S(" Yes "),wa={key:0,class:"fixed z-50 inset-0 flex items-center justify-center"},ya=c("div",{class:"absolute inset-0 bg-blue-300 bg-opacity-80"},null,-1),_a={class:"relative z-10 p-6 pb-7 rounded bg-white shadow-block"},ba=c("h2",{class:"text-base font-bold"}," You lost! ",-1),va={class:"flex space-x-4 items-center justify-center mt-6"},xa=S(" Admit Defeat "),ka={key:0,class:"fixed z-50 inset-0 flex items-center justify-center"},za=c("div",{class:"absolute inset-0 bg-blue-300 bg-opacity-80"},null,-1),Ea={class:"relative z-10 p-6 pb-7 rounded bg-white shadow-block text-center"},Ma={class:"text-base font-bold"},Ia={class:"mt-2 text-sm"},Sa=S(" You scored a total of "),Ca=S(" points. "),Pa={class:"flex space-x-4 items-center justify-center mt-6"},Oa={setup(r){let t=null,e=null;const n=nt(()=>e._board._airplanesQueue.map(y=>e._airplanes.value.find(g=>g._id===y._id)||y)),s=nt(()=>Wt(e._tick.value)),a=nt(()=>e._score.value),o=(y,f)=>{const g=y._id===i.value?._id,C=y._flightStatus===L.IN_FLIGHT,Y=[y._flightStatus===L.APPROACHING&&"bg-blue-200 text-blue-400 cursor-not-allowed",y._flightStatus===L.SCHEDULED&&"text-gray-400 cursor-not-allowed",y._flightStatus===L.LANDED&&"bg-teal-100 text-teal-500 cursor-not-allowed",y._flightStatus===L.EXITED&&"bg-teal-100 text-teal-500 cursor-not-allowed",y._flightStatus===L.LOST&&"bg-rose-100 text-rose-400 cursor-not-allowed"],H=["bg-blue-500 text-white hover:bg-blue-600 border-b-2 border-blue-800"],F=[!g&&f%2===0&&"bg-gray-100",!g&&"hover:bg-gray-200"];return[...g?[]:Y,...g?H:[],...C?F:[]]};sn(()=>{mn(),E.autoRotate=!1,E.enablePan=!0;let y,f;M.onTransition(async A=>{if(A.changed&&A.matches("introIn")&&(E.autoRotate=!0,t=new hs,t.start(),t.render(),await t.animateIn(),M.send("DONE")),A.changed&&A.matches("introOut")&&(E.enableRotate=!1,E.autoRotate=!1,await t.animateOut(),M.send("DONE")),A.changed&&A.matches("gameIn")){t.reset(),e=new ps,y=pt(e._tick,()=>{clearInterval(b.value),m.value=0,b.value=setInterval(()=>{m.value++},1e3)}),f=pt(e._airplanes,ot=>{ot.find(tt=>tt._id===i.value?._id)||(i.value=null)}),e.start(),e.render();const $=O.position;new p.Tween($).to({x:80,y:35,z:80},1500).easing(p.Easing.Cubic.InOut).onUpdate(()=>O.position.set($.x,$.y,$.z)).onComplete(()=>{E.enableRotate=!0,E.enableZoom=!0,M.send("DONE")}).start(),await e.animateIn()}if(A.changed&&A.matches("gamePlaying")&&(E.enableRotate=!0),A.changed&&A.matches("gameOut")){E.enableRotate=!1;const $=O.position;new p.Tween($).to({x:15,y:9,z:15},1500).easing(p.Easing.Cubic.InOut).onUpdate(()=>O.position.set($.x,$.y,$.z)).onComplete(()=>{E.enableRotate=!0,E.enableZoom=!0,M.send("DONE")}).delay(500).start(),await e.animateOut(),e.reset(),y(),f()}});let g=0,C=1/60;const Y=new an,H=new on;let F=!1;const K=A=>{F=!0,H.x=A.clientX/window.innerWidth*2-1,H.y=-(A.clientY/window.innerHeight)*2+1},gt=()=>{F=!1};J.setAnimationLoop(async A=>{if(g+=wn.getDelta(),Ht.begin(),M.state.hasTag("intro")&&t._scene)J.render(t._scene,O),g>C&&t._animate();else if(M.state.hasTag("board")&&e._scene){if(F){Y.setFromCamera(H,O);const tt=Y.intersectObjects(e._scene.children).sort((ht,yt)=>ht.distance<yt.distance).find(ht=>ht.object.parent.name==="plane");tt&&(d(tt.object.parent),F=!1)}J.render(e._scene,O),g>C&&e._animate()}E.update(),p.update(A),Ht.end(),g=g%C});const dt=()=>{O.aspect=window.innerWidth/window.innerHeight,O.updateProjectionMatrix(),J.setSize(window.innerWidth,window.innerHeight)};window.addEventListener("resize",dt,!1),window.addEventListener("mousedown",K),window.addEventListener("mouseup",gt),M.send("INTRO_IN")});const l=async()=>{await e.nextTick()};et(!1);const i=et(null);pt(i,y=>{y||fn()});const d=y=>{if(e.selectPlane(y._id),i.value=e._airplanes.value.find(f=>f._isSelected),i.value){const f=E.target,g=i.value._model.position;new p.Tween(f).to(g,500).easing(p.Easing.Cubic.InOut).onUpdate(()=>E.target=f).start();const{x:C,y:Y,z:H}=i.value._model.position,F=kn(i.value._direction),K={x:O.position.x,y:O.position.y,z:O.position.z},gt={x:C+20*F.x,y:Y+10,z:H+20*F.z};new p.Tween(K).to(gt,500).easing(p.Easing.Cubic.InOut).onUpdate(()=>{O.position.set(K.x,K.y,K.z),E.update()}).start()}},u=y=>{i.value&&!i.value._isGhost&&i.value.setHeight(y)},h=y=>{i.value&&!i.value._isGhost&&i.value.setDirection(y)},m=et(0),b=et(null);pt(m,async y=>{y===30&&await e.nextTick()}),pt(T,y=>{(y.matches("gamePlaying.lose")||y.matches("gamePlaying.win")||y.matches("gameOut"))&&clearInterval(b.value)});const I=nt(()=>({background:`conic-gradient(#3b82f6 ${m.value/30*360}deg, transparent ${m.value/30*360}deg)`}));return(y,f)=>(G(),D(bt,null,[ms,c("div",gs,[x(W,{"enter-active-class":"transition duration-500 ease-[cubic-bezier(.75,-0.4,.25,1.4)]","enter-from-class":"scale-50 opacity-0","enter-to-class":"scale-100 opacity-100","leave-active-class":"transition duration-500 ease-in","leave-from-class":"scale-100 opacity-100","leave-to-class":"scale-95 opacity-0"},{default:k(()=>[w(T).matches("introIdle")?(G(),D("div",fs,ys)):j("",!0)]),_:1}),x(W,{"enter-active-class":"transition duration-500 ease-[cubic-bezier(.75,-0.4,.25,1.4)] delay-100","enter-from-class":"scale-50 opacity-0","enter-to-class":"scale-100 opacity-100","leave-active-class":"transition duration-500 ease-in delay-200","leave-from-class":"scale-100 opacity-100","leave-to-class":"scale-95 opacity-0"},{default:k(()=>[w(T).matches("introIdle")?(G(),D("div",_s,[x(P,{size:"lg",onClick:f[0]||(f[0]=g=>w(M).send("INTRO_OUT"))},{default:k(()=>[bs]),_:1})])):j("",!0)]),_:1}),x(W,{"enter-active-class":"transition duration-500 ease-[cubic-bezier(.75,-0.4,.25,1.4)] delay-200","enter-from-class":"scale-50 opacity-0","enter-to-class":"scale-100 opacity-100","leave-active-class":"transition duration-500 ease-in delay-100","leave-from-class":"scale-100 opacity-100","leave-to-class":"scale-95 opacity-0"},{default:k(()=>[w(T).matches("introIdle")?(G(),D("div",vs,[x(P,{"is-secondary":w(T).context.difficulty===1,"is-primary":w(T).context.difficulty===2,onClick:f[1]||(f[1]=g=>w(M).send("DIFFICULTY"))},{default:k(()=>[S(Z(w(he)[w(T).context.difficulty]),1)]),_:1},8,["is-secondary","is-primary"])])):j("",!0)]),_:1}),w(T).hasTag("board")?(G(),D(bt,{key:0},[x(W,{"enter-active-class":"transition duration-200 ease-in-out delay-100","enter-from-class":"transform scale-50 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-200 ease-in-out delay-300","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-50 opacity-0"},{default:k(()=>[w(T).matches("gamePlaying")?(G(),D("div",xs,[c("div",ks,[zs,c("div",{class:rt(["font-bold",w(a)<0?"text-rose-500":w(a)>0?"text-green-500":"text-blue-500"])},Z(w(a)),3)])])):j("",!0)]),_:1}),x(W,{"enter-active-class":"transition duration-200 ease-in-out delay-200","enter-from-class":"transform scale-50 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-200 ease-in-out delay-200","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-50 opacity-0"},{default:k(()=>[w(T).matches("gamePlaying")?(G(),D("div",Es,[c("div",{class:"flex justify-center items-center rounded-full w-16 h-16 shadow-block bg-white cursor-pointer transform hover:bg-blue-200 transition-colors",onClick:l},[c("div",{class:"rounded-full w-16 h-16 border-2 border-white",style:rn(w(I))},null,4)]),c("div",Ms,[Is,c("div",Ss,Z(w(s)),1)])])):j("",!0)]),_:1}),x(W,{"enter-active-class":"transition duration-200 ease-in-out delay-300","enter-from-class":"transform scale-50 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-200 ease-in-out delay-100","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-50 opacity-0"},{default:k(()=>[w(T).matches("gamePlaying")?(G(),D("div",Cs,[c("div",Ps,[Os,c("div",As,[c("table",Ls,[Ts,c("tbody",Gs,[(G(!0),D(bt,null,$t(w(n),(g,C)=>(G(),D("tr",{key:g._id,class:rt(["transition-colors cursor-pointer",o(g,C)]),onClick:Y=>g._flightStatus===w(L).IN_FLIGHT?d(g):null},[c("td",Rs,Z(w(Wt)(g._startTime)),1),c("td",Xs,Z(g._flightStatus),1),c("td",Ns,Z(g._start.name),1),c("td",Us,Z(g._end.name),1),c("td",Ys,Z(g._fuel),1)],10,Ds))),128))])])])])])):j("",!0)]),_:1}),x(W,{"enter-active-class":"transition duration-200 ease-in-out delay-[400ms]","enter-from-class":"transform scale-50 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-200 ease-in-out","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-50 opacity-0"},{default:k(()=>[w(T).matches("gamePlaying")?(G(),D("div",Zs,[x(P,{onClick:f[2]||(f[2]=g=>w(M).send("QUIT"))},{default:k(()=>[Bs]),_:1})])):j("",!0)]),_:1}),x(W,{"enter-active-class":"transition duration-200 ease-in-out","enter-from-class":"transform scale-50 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-200 ease-in-out","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-50 opacity-0"},{default:k(()=>[ln(c("div",Fs,[c("div",$s,[Hs,c("div",Ws,[c("div",js,[Qs,c("div",qs,[x(P,{size:"control","is-primary":i.value?._targetDirection===-1,onClick:f[3]||(f[3]=g=>h(-1))},{default:k(()=>[Ks]),_:1},8,["is-primary"]),x(P,{size:"control",class:"row-span-2","is-primary":i.value?._targetDirection===0&&i.value?._targetAltitude!==0,onClick:f[4]||(f[4]=g=>{h(0),u(i.value?._position.y)})},{default:k(()=>[Vs]),_:1},8,["is-primary"]),x(P,{size:"control","is-primary":i.value?._targetDirection===1,onClick:f[5]||(f[5]=g=>h(1))},{default:k(()=>[Js]),_:1},8,["is-primary"]),x(P,{size:"control","is-primary":i.value?._targetDirection===-2,onClick:f[6]||(f[6]=g=>h(-2))},{default:k(()=>[ta]),_:1},8,["is-primary"]),x(P,{size:"control","is-primary":i.value?._targetDirection===2,onClick:f[7]||(f[7]=g=>h(2))},{default:k(()=>[ea]),_:1},8,["is-primary"]),x(P,{size:"control","is-primary":i.value?._targetDirection===-3,onClick:f[8]||(f[8]=g=>h(-3))},{default:k(()=>[na]),_:1},8,["is-primary"]),x(P,{size:"control","is-primary":i.value?._targetDirection===0&&i.value?._targetAltitude===0,onClick:f[9]||(f[9]=g=>{h(0),u(0)})},{default:k(()=>[sa]),_:1},8,["is-primary"]),x(P,{size:"control","is-primary":i.value?._targetDirection===3,onClick:f[10]||(f[10]=g=>h(3))},{default:k(()=>[aa]),_:1},8,["is-primary"]),x(P,{size:"control","is-primary":i.value?._targetDirection===-4,onClick:f[11]||(f[11]=g=>h(-4))},{default:k(()=>[oa]),_:1},8,["is-primary"]),x(P,{size:"control","is-disabled":""},{default:k(()=>[ia]),_:1}),x(P,{size:"control","is-primary":i.value?._targetDirection===4,onClick:f[12]||(f[12]=g=>h(4))},{default:k(()=>[ra]),_:1},8,["is-primary"])])]),c("div",la,[ca,c("div",da,[(G(),D(bt,null,$t([0,1,2,3,4,5,6,7,8],g=>x(P,{key:g,size:"control","is-secondary":i.value?._position.y===g&&i.value?._targetAltitude!==g,"is-primary":i.value?._targetAltitude===g,onClick:C=>u(g)},{default:k(()=>[S(Z(g),1)]),_:2},1032,["is-secondary","is-primary","onClick"])),64))])])])])],512),[[cn,w(T).matches("gamePlaying")&&i.value]])]),_:1}),x(W,{"enter-active-class":"transition duration-100 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-75 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:k(()=>[w(T).matches("gamePlaying.quit")?(G(),D("div",ha,[c("div",{class:"absolute inset-0 bg-blue-300 bg-opacity-80",onClick:f[13]||(f[13]=dn(g=>w(M).send("CANCEL"),["self"]))}),c("div",ua,[pa,c("div",ma,[x(P,{size:"sm","is-secondary":"",onClick:f[14]||(f[14]=g=>w(M).send("CANCEL"))},{default:k(()=>[ga]),_:1}),x(P,{size:"sm","is-primary":"",onClick:f[15]||(f[15]=g=>w(M).send("DONE"))},{default:k(()=>[fa]),_:1})])])])):j("",!0)]),_:1}),x(W,{"enter-active-class":"transition duration-100 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-75 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:k(()=>[w(T).matches("gamePlaying.lose")?(G(),D("div",wa,[ya,c("div",_a,[ba,c("div",va,[x(P,{size:"sm","is-primary":""},{default:k(()=>[xa]),_:1})])])])):j("",!0)]),_:1}),x(W,{"enter-active-class":"transition duration-100 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-75 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:k(()=>[w(T).matches("gamePlaying.win")?(G(),D("div",ka,[za,c("div",Ea,[c("h2",Ma," You won"+Z(w(a)<0?" (sort of)":"")+"! "+Z(w(a)<0?"\u{1F605}":"\u{1F389}"),1),c("p",Ia,[Sa,c("span",{class:rt(["font-bold",w(a)<0?"text-rose-500":w(a)>0?"text-green-500":"text-blue-500"])},Z(w(a)),3),Ca]),c("div",Pa,[x(P,{size:"sm","is-primary":"",onClick:f[16]||(f[16]=g=>w(M).send("DONE"))},{default:k(()=>[S(" Nice"+Z(w(a)<0?"-ish":"")+"! ",1)]),_:1})])])])):j("",!0)]),_:1})],64)):j("",!0)])],64))}};hn(Oa).mount("#app");
